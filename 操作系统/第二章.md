# 第二章 进程的描述与控制
## 2.1 前驱图和程序执行
### 2.1.1 前驱图
定义：有向无循环图（DAG），是一个二元组，由结点的集合和有向边组成。  
结点：表示一个进程、程序段或语句  
有向边：两个结点之间的前驱关系，也叫偏序关系，记为'->'。  
若P<sub>i</sub>和P<sub>j</sub>存在前驱关系，则记作P<sub>i</sub>->P<sub>j</sub>，表示P<sub>i</sub>必须在P<sub>j</sub>执行前完成。同时P<sub>i</sub>是P<sub>j</sub>的直接前驱，P<sub>j</sub>和P<sub>i</sub>的直接后继。  
没有前驱的结点称为初始结点。  
没有后继的结点称为终止结点。  
### 2.1.2 程序顺序执行
通常一个程序可分成若干个程序段，它们必须按照某种先后次序执行，仅当前一操作执行后，才能执行后继操作。

程序顺序执行时有如下特征：  
* 顺序性：处理机的操作严格按照程序所规定的顺序执行，每一操作必须在下一个操作开始之前结束。  
* 封闭性：在封闭环境下执行，独占全机资源，执行结果不受外界影响。
* 可再现性：只要程序执行时的环境和初始条件相同，当程序重复执行时，不论它是从头到尾不停顿地执行，还是“走走停停”地执行，都将获得相同的结果。

### 2.1.3 程序并发执行
程序并发执行时的特征：
* 间断性：相互制约导致并发程序具有“执行-暂停-执行”这种间断性的活动规律。
* 失去封闭性：多个程序共享系统中的各种资源，资源状态由多个程序来改变。
* 不可再现性：由于程序的并发执行，打破了由一个程序独占系统资源的封闭性，因而破坏了可再现性。  

程序并发执行的条件（Bernstein条件)：  
读集 R(p<sub>i</sub>)={a1,a2,a3,…,am}：  
表示程序pi在执行期间所需参考的所有变量的集合。  
写集 W(p<sub>i</sub>)={b1,b2,b3,…,bm}：  
表示程序pi在执行期间要改变的所有变量的集合。  
若两个程序p1和p2能满足下述条件，它们便能并发执行，且具有可再现性。  
R(p1)$\bigcap$W(p2)$\bigcup$R(p2)$\bigcap$W(p1)$\bigcup$W(p1)$\bigcap$W(p2)={}

## 2.2 进程的描述
### 2.2.1 进程的定义和特征  

进程(process)的定义：  
1）进程是程序的一次执行。  
2）进程是一个程序及其数据在处理机上顺序执行时所发生的活动。  
3）进程是程序在一个数据集合上的运行过程，它是系统进行资源分配和调度的一个独立单位。  
传统os中的进程定义为：进程是进程实体的运行过程，是系统进行资源分配和调度的一个独立单位。  
进程实体由程序段、相关的数据段和PCB三部分构成。  

进程和程序的主要区别：  
* 程序是指令的有序集合，其本身没有任何运行的含义，它是一个**静态**的概念。而进程是程序在处理机上的一次执行过程，它是一个**动态**概念。
* 程序的**存在是永久**的。而**进程则是有生命期**的，**它因创建而产生，因调度而执行，因得不到资源而暂停执行，因撤消而消亡。**
* 程序仅是**指令的有序集合**。而进程则由**程序段**、**相关数据段**、 **进程控制块（PCB）** 组成。
* **进程与程序之间不是一一对应**。一个程序可对应多个进程、一个进程可包含多个程序（至少包含一个程序）  
* 程序存储在外存、进程存储在内存。

进程的特征：
1. 结构特征：由程序段、相关数据段及进程控制块（PCB）组成。
2. 动态性：进程的实质是进程实体的一次执行过程，因此是动态的。所以动态性是进程的最基本的特征。同时动态性还表现在进程是有生命期的，它因创建而产生，因调度而执行，因得不到资源而暂停执行，因撤消而消亡。  
3. 并发性：指多个进程实体同时存在于内存中，能在一段时间内同时运行。引入进程的目的就是为了使进程能并发执行，以提高资源利用率，所以并发性是进程的重要特征，也是OS的重要特征。
4. 独立性：指进程是一个能独立运行的基本单位，也是系统进行资源分配和调度的独立单位。
5. 异步性：指进程以各自独立的、不可预知的速度向前推进。

### 2.2.2 进程的基本状态及转换
为了刻画了整个进程，可以将一个进程的生命周期划分为一组状态：
两种短暂的状态、三种基本状态。  
* new新建/创建:进程正在创建中的状态
* terminated终止/撤消/退出：进程执行完毕，释放所占资源的状态。
* ready-就绪: 进程已获得了除处理机以外的所有资源，等待分配处理机执行的状态。
* running-运行/执行: 当一个进程获得必要的资源并正在处理机上执行的状态。
* waiting-等待/阻塞: 正在执行的进程由于发生某事件而暂时无法执行下去，此时进程所处的状态。
